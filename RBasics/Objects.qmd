---
title: "Objects (Data Structures)"
subtitle: ""
---

------------------------------------------------------------------------

In R, **Data Structures** are the containers used to store and organize values.

R provides several built-in structures, each designed for a specific purpose. Understanding the difference between them is critical for data analysis.

| Data Structure | Dimensions | Contains Same Type? | Use Case |
|:-----------------|:-----------------|:-----------------|:-----------------|
| **Vector** | 1D | **Yes** | Simple sequences of numbers or text. |
| **Factor** | 1D | **No** (Technically Integers) | Categorical data (groups, treatments). |
| **List** | 1D | **No** | Storing complex, mixed objects together. |
| **Matrix** | 2D | **Yes** | Mathematical tables (e.g., gene counts). |
| **Array** | n-D | **Yes** | Multi-dimensional data (3D+). |
| **Data Frame** | 2D | **No** | Standard datasets (rows = samples, cols = variables). |
| **NULL** | \- | \- | \- |

![](../images/DataStructures.png){fig-align="center" width="800"}

## 1. Overview of data dimension

:::::: columns
::: {.column width="45%"}
### **1D Structures**

(Vector, Factor, List) ![](../images/1D_DataStructures.png){.border}
:::

::: {.column width="10%"}
:::

::: {.column width="45%"}
### **2D Structures**

(Matrix, Data Frame) ![](../images/2D_DataStructures.png){.border}
:::
::::::

## 2. Vector

**Key points:** \* The fundamental building block of R. \* Can only contain objects of the **same class** (e.g., all numeric or all character). \* Even a single number in R is actually a vector of length 1.

![](../images/Vectors.png)

### 2.1 Numeric Vectors

There are multiple ways to create numeric vectors.

#### **2.1.1 Method A: `c()` (Combine)**

This is the most common method.

```{r}
x <- c(0.3, 0.1)
x
```

::: callout-tip
Coding Style:

The Comma Rule It is not mandatory to put a space after a comma—both `c(0.3, 0.1)` and `c(0.3,0.1)` will work perfectly.

However, much like writing in English, your code is significantly easier for others (and your future self) to read if you consistently place a space after every comma. It makes your code look professional and clean.
:::

#### **2.1.2 Method B: `vector()` or `numeric()`**

Creates an empty vector of a specific size (defaults to 0).

```{r}
x <- vector(mode = "numeric", length = 10)
x
```

```{r}
x <- numeric(length = 10)
x
```

#### **2.1.3 Method C: `seq()` and `rep()`**

Sequences (seq and rep) Useful for generating data automatically.

```{r}
# Sequence from 1 to 10, jumping by 2
x <- seq(from = 1, to = 10, by = 2)
x

# Repeat the number 2, 10 times
x <- rep(2, 10)
x
```

::: callout-tip
Checking Vector Length with `length()`

```{r}
#| collapse: true
## Creates an empty vector of length 10
x <- vector(mode = "numeric", length = 10)
x
length(x)

# Repeat the number 2, 5 times
y <- rep(2, 5)
y
length(y)

length(x) == length(y)

```
:::

### 2.2 Integer Vectors

Integers are whole numbers. You force them by adding L.

Creating an integer vector using `c()`

```{r}
x <- c(1L, 2L, 3L, 4L, 5L)  
x
```

**The Colon Operator (:)** The quickest way to make an integer sequence.

```{r}
x <- 1:10
x
```

::: callout-note
Notes:

You can read the `:` symbol as **"from... to..."**

-   `1:10` means "from 1 to 10."

-   `50:100` means "from 50 to 100."
:::

### 2.3 Logical Vectors

Used for True/False conditions.

```{r}
# You can use TRUE/FALSE or T/F
x <- c(TRUE, FALSE, T, F)
x
```

Creating a logical vector with `vector()`

```{r}
x <- vector(mode = "logical", length = 5)
x
```

Creating a logical vector using `logical()`

```{r}
x <- logical(length = 10)
x
```

### 2.4 Character Vectors

Text strings must be wrapped in quotes.

```{r}
#| collapse: true
x <- c("a", "b", "c")
x

x <- vector(mode = "character", length=10)
x

x <- character(length = 3)
x
```

::: callout-tip
Useful String Functions

```{r}
# Convert to Lowercase
tolower(c("DNA", "RNA"))

# Convert to UPERCASE
toupper(letters)

# Create labels by pasting text and numbers
# Note the implicit coercion
paste("Patient", 1:5, sep = "_")
```
:::

::: callout-note
In R, coercion is the process of forced conversion from one data type to another.

R is automatically changing the Numeric vector (1:5) into a Character vector so it can be "pasted" together with the Character vector ("Patient").

1.  The Rule of Vectors

As we learned earlier, a vector must contain objects of the same class. You cannot have a single vector that is half-numbers and half-text.

2.  What happens in paste()?

When you run `paste("Patient", 1:5, sep = "_")`:

"Patient" is a Character vector.

1:5 is an Integer/Numeric vector (1, 2, 3...).

Since you can't join "text" and "numbers" into a single result without them being the same type, R implicitly (automatically) converts the numbers into text strings ("1", "2", "3").

Why is this important?

In R, there is a "Hierarchy of Types." If you mix different types in a vector, R will always coerce them to the "least restrictive" type to ensure no data is lost, following this order:

Logical → Integer → Numeric → Character

Example of unexpected coercion:

If you accidentally include a single piece of text in your column of gene expression numbers, R will turn the entire column into text.

```{r}
# Mixing numbers and one "missing" string
data <- c(1.2, 3.5, "missing", 4.8)

# Check the class
class(data)
```

Because of coercion, you can no longer calculate the mean() or sum() of that data because R now sees them all as "character" rather than "numbers." This is a very common reason why R scripts fail during data cleaning!

```{r}
#| error: true

# Mixing numbers and one "missing" string
data <- c(1.2, 3.5, "missing", 4.8)

mean(data)
```
:::

### 2.5 Vector Attributes (Names)

You can give names to specific elements in a vector. This is great for readability.

```{r}
x <- 1:5
names(x) <- c("one", "two", "three", "four", "five")
x

x <- logical(length = 4)
names(x) <- c("F1", "F2", "F3", "F4")
x
```

## 3. Factors

Key points:

-   Used for Categorical Data (e.g., "Control" vs "Treatment").

-   Levels: The fixed set of possible values.

-   Can have implicit order, if needed

-   Each element has a label or level

-   Essential for statistical modeling (e.g., defining groups for DESeq2).

-   Some operations behave differently on factors

![](../images/Factors.png){fig-align="center" width="300"}

**Creating Factors:** Notice below that we explicitly define the levels. This sets the "order" of the groups (Control first, Case second).

```{r}
cols <- factor(x = c(rep("red", 4),
                   rep("blue", 5),
                   rep("green", 2)),              
             levels = c("red", "blue", "green"))
cols
```

```{r}
samples <- c("case", "control", "control", "case") 
samples_factor <- factor(samples, levels = c("control", "case")) 

samples_factor 
str(samples_factor)
```

## 4. List

**Key points:**

-   The "Super Container".

-   Can contain mixed data types (e.g., a vector, a matrix, and a string all in one object).

-   The output of most statistical tests (like t.test) is a list.

**Creating a List:**

```{r}
my_list <- list(
  project_name = "Diabetes Study",
  patient_count = 50,
  is_finished = FALSE,
  group_ids = c("A", "B", "C")
)

my_list
```

**Accessing List Elements:** Use the **double bracket** `[[ ]]` or the **dollar sign** `$`.

```{r}
my_list$project_name

my_list[["group_ids"]]
```

## 5. Matrix

**Key points:**

-   2-Dimensional (Rows and Columns).

-   Must contain One Data Type (usually all Numeric).

-   Used heavily in bioinformatics for Gene Expression Tables (Genes × Samples).

**Creating a Matrix:**

```{r}
# Create a matrix of numbers 1 through 9, arranged in 3 rows
m <- matrix(1:9, nrow = 3, ncol = 3)
m
```

**Adding Row/Column Names:**

```{r}
m <- matrix(1:9, nrow = 3, ncol = 3)
colnames(m) <- c("Sample1", "Sample2", "Sample3")
rownames(m) <- c("GeneA", "GeneB", "GeneC")
m
```

## 6. Array

**Key points:**

-   Similar to a matrix, but can have more than 2 dimensions (3D, 4D, etc.).

-   Useful for time-series data or 3D imaging data.

```{r}
# Create a 3D array (2 rows, 2 columns, 2 "slices")
a <- array(1:8, dim = c(2, 2, 2))
a
```

## 7. Data Frame

**Key points:**

-   The most common data structure for researchers.

-   2-Dimensional (like a matrix).

-   Can mix data types (e.g., Column 1 is Numeric, Column 2 is Character).

-   Think of it like an Excel Spreadsheet.

**Creating a Data Frame:**

```{r}
df <- data.frame(
  ID = c("P001", "P002", "P003"),
  Age = c(25, 34, 28),
  Treatment = c("Placebo", "Drug", "Placebo")
)
df
```

## 8. NULL (The Empty Object)

**Key points:**

-   NULL represents the absence of an object.

-   It is different from NA (which means "missing value").

-   NULL is often used to remove an element from a list or dataframe.

```{r}
x <- NULL
is.null(x)
```

## 9. Built-in Functions

R has many functions to inspect and summarize these objects.

#### **9.1 Inspection Functions**

Use these to check what you are working with.

```{r}
#| collapse: true
x <- c(1, 2, 3)

is.vector(x)    # Is it a vector?
is.na(x)    # Is it empty
is.null(x)    # Is it NULL
is.numeric(x)    # Is it numeric
is.logical(x)    # Is it logical
is.character(x)    # Is it character

length(x)       # How long is it?

class(x)        # What class is it? Atomic class type
typeof(x) # Object type or data structure (matrix, list, array...)
str(x)          # Structure (Compact display)
```

#### **9.2 Mathematical Summaries**

Use these to calculate statistics on your vectors.

```{r}
#| collapse: true
x <- seq(1, 10, 0.3)

min(x) 
max(x)

mean(x)    # Average
median(x)  # Median
sd(x)      # Standard Deviation

summary(x) # Quick summary stats

table(x)
```

#### **9.3 Grouping Data (`tapply`)**

A powerful function to apply a calculation to groups of data (e.g., "Find the mean measurement for Cases vs. Controls").

```{r}
# Mock data: 6 measurements
measurements <- c(10, 12, 11, 20, 22, 21)

# Groups: 3 Controls, 3 Cases
groups <- factor(c("Control", "Control", "Control", "Case", "Case", "Case"))


# Calculate the mean for each group
tapply(measurements, groups, mean)
```

## 10. Vector Operations

R is vectorized, meaning mathematical operations are applied to every element at once.

```{r}
#| collapse: true
x <- 1:5
y <- 6:10

# Multiply every element in x by 2
x * 2

# Add x and y (element by element)
x + y
```
